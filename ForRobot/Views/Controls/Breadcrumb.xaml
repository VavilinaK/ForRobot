<ComboBox x:Class="ForRobot.Views.Controls.Breadcrumb"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:local="clr-namespace:ForRobot.Views.Controls"
             xmlns:conv="clr-namespace:ForRobot.Libr.Converters"
             mc:Ignorable="d">
    
    <ComboBox.Resources>
        <!--Colors-->
        <Color x:Key="DarkGrayColor">#FF707070</Color>
        <Color x:Key="BlackColor">#FF000000</Color>
        <Color x:Key="LightBlue">#b5eaff</Color>
        <Color x:Key="LightMediumBlue">#85caff</Color>

        <!--SolidColorBrushs-->
        <SolidColorBrush x:Key="WhiteBrush" Color="White"/>
        <SolidColorBrush x:Key="NotActiveBorderBrush" Color="{DynamicResource DarkGrayColor}"/>
        <SolidColorBrush x:Key="ActiveBackround" Color="{DynamicResource LightBlue}"/>
        <SolidColorBrush x:Key="IsSelectedBackround" Color="{DynamicResource LightMediumBlue}"/>

        <!--Geometry-->
        <Geometry x:Key="NormalArrow">M0,0 L4,3.5 0,7 z</Geometry>
        <Geometry x:Key="ExpandedArrow">M0,3 L7,3 3.5,7 z</Geometry>
        
        <!--Converters-->
        <conv:ArrayMultiValueConverter x:Key="ArrayMultiValueConvert"/>
        <!--<conv:NullBooleanConverter x:Key="NullBooleanConvert"/>-->

        <!--Styles-->
        <Style x:Key="IconStyle" TargetType="{x:Type Path}">
            <Setter Property="Fill" Value="{Binding Path=IconsBackground, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"/>

            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=IconsBackground, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}" Value="{x:Null}">
                    <Setter Property="Fill" Value="Black"/>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!--Template-->
        <ControlTemplate x:Key="buttonTemplate" TargetType="{x:Type Button}">
            <Border Name="buttonPanel" BorderThickness="1">                
                <ContentPresenter x:Name="ContentSite"
                                  VerticalAlignment="Center" HorizontalAlignment="Center"
                                  ContentSource="Content" Margin="5"/>
                <Border.Style>
                    <Style TargetType="{x:Type Border}">
                        <Setter Property="BorderBrush" Value="{DynamicResource NotActiveBorderBrush}"/>
                        <Setter Property="Background" Value="Transparent"/>

                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource AncestorType={x:Type Button}, Mode=FindAncestor}}"  Value="True">
                                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                <Setter Property="Background" Value="{DynamicResource ActiveBackround}"/>
                            </DataTrigger>

                            <DataTrigger Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type Button}, Mode=FindAncestor}}" Value="True">
                                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                <Setter Property="Background" Value="{DynamicResource ActiveBackround}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
            </Border>
        </ControlTemplate>

        <ControlTemplate x:Key="listBoxItemTemplate" TargetType="{x:Type ListBoxItem}">
            <Border BorderThickness="0">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ContentPresenter Grid.Column="0" VerticalAlignment="Center" HorizontalAlignment="Center" Margin="5, 0"
                                      Content="{Binding Path=Content, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}"/>

                    <ToggleButton Grid.Column="1" x:Name="toggleButtonMenu"
                                  IsChecked="{Binding Path=IsSelected, RelativeSource={RelativeSource AncestorType=ListBoxItem, Mode=FindAncestor}, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">

                        <ToggleButton.Template>
                            <ControlTemplate TargetType="{x:Type ToggleButton}">
                                <Border Background="Transparent" BorderThickness="0.5">
                                    <Path Fill="#FF000000" HorizontalAlignment="Center" VerticalAlignment="Center"
                                          Margin="5" IsHitTestVisible="True">

                                        <Path.Style>
                                            <Style TargetType="{x:Type Path}">
                                                <Setter Property="Data" Value="{StaticResource NormalArrow}"/>

                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=IsChecked, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}" Value="True">
                                                        <Setter Property="Data" Value="{StaticResource ExpandedArrow}"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Path.Style>
                                    </Path>

                                    <Border.Style>
                                        <Style TargetType="{x:Type Border}">
                                            <Setter Property="BorderBrush" Value="Transparent"/>

                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path=IsSelected, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}"  Value="True">
                                                    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}"  Value="True">
                                                    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                                </DataTrigger>

                                                <DataTrigger Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}" Value="True">
                                                    <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                </Border>
                            </ControlTemplate>
                        </ToggleButton.Template>
                    </ToggleButton>

                    <Popup IsOpen="{Binding Path=IsChecked, ElementName=toggleButtonMenu}" StaysOpen="True" Placement="Bottom"
                           PlacementTarget="{Binding ElementName=toggleButtonMenu}" AllowsTransparency="True"
                           PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}">

                        <Border BorderBrush="Black" BorderThickness="1">
                            <ListBox FontSize="14" SelectionMode="Single" Margin="{Binding Padding}"
                                     ItemsSource="{Binding Path=ChildrenFolder, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">

                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <Image Grid.Column="0" Source="{Binding Icon}" Stretch="Fill" Height="25"/>
                                            <Label Grid.Column="1" Content="{Binding Name}"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>

                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="SelectionChanged">
                                        <i:InvokeCommandAction Command="{Binding Path=SelectMenuItemCommand, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">
                                            <i:InvokeCommandAction.CommandParameter>
                                                <MultiBinding Converter="{StaticResource ArrayMultiValueConvert}">
                                                    <Binding Path="." RelativeSource="{RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}"/>
                                                    <Binding Path="SelectedItem" RelativeSource="{RelativeSource AncestorType={x:Type ListBox}, Mode=FindAncestor}"/>
                                                </MultiBinding>
                                            </i:InvokeCommandAction.CommandParameter>
                                        </i:InvokeCommandAction>
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </ListBox>

                            <Border.Style>
                                <Style TargetType="{x:Type Border}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=CanOpenMenu, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"
                                                     Value="False">
                                            <Setter Property="Visibility" Value="Hidden"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                        </Border>
                    </Popup>
                </Grid>

                <Border.Style>
                    <Style TargetType="{x:Type Border}">
                        <Setter Property="Background" Value="Transparent"/>

                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=IsSelected, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}"  Value="True">
                                <Setter Property="Background" Value="{DynamicResource IsSelectedBackround}"/>
                            </DataTrigger>

                            <DataTrigger Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}"  Value="True">
                                <Setter Property="Background" Value="{DynamicResource ActiveBackround}"/>
                            </DataTrigger>

                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}" Value="True"/>
                                    <Condition Binding="{Binding Path=IsSelected, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}}"  Value="False"/>
                                </MultiDataTrigger.Conditions>

                                <Setter Property="Background" Value="{DynamicResource ActiveBackround}"/>
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>

                <Border.InputBindings>
                    <MouseBinding MouseAction="LeftClick" Command="{Binding Path=SelectDirectoryCommand, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">
                        <MouseBinding.CommandParameter>
                            <MultiBinding Converter="{StaticResource ArrayMultiValueConvert}">
                                <Binding Path="ItemsSource" RelativeSource="{RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}"/>
                                <Binding Path="Content" RelativeSource="{RelativeSource AncestorType={x:Type ListBoxItem}, Mode=FindAncestor}"/>
                                <Binding Path="." RelativeSource="{RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}"/>
                            </MultiBinding>
                        </MouseBinding.CommandParameter>
                    </MouseBinding>
                </Border.InputBindings>
            </Border>
        </ControlTemplate>
    </ComboBox.Resources>

    <ComboBox.Style>
        <Style TargetType="{x:Type ComboBox}">
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
            <Setter Property="VerticalContentAlignment" Value="Stretch"/>
            <Setter Property="ItemsPanel">
                <Setter.Value>
                    <ItemsPanelTemplate>
                        <StackPanel IsItemsHost="True" />
                    </ItemsPanelTemplate>
                </Setter.Value>
            </Setter>

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ComboBox}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <Grid.Style>                                
                                <Style TargetType="{x:Type Grid}">
                                    <Setter Property="Background" Value="{Binding Path=Background, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"/>

                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=Background, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"
                                                     Value="{x:Null}">
                                            
                                            <Setter Property="Background" Value="White"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Grid.Style>

                            <Button Grid.Column="0" x:Name="buttonHome" ToolTip="Возврат к начальной папке"
                                    Width="Auto" Margin="0"
                                    Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"
                                    Template="{StaticResource buttonTemplate}"
                                    Command="{Binding Path=HomeCommand, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"
                                    CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">

                                <Path Style="{StaticResource IconStyle}"
                                      Data="M 9, 20 V 14 H 13 V 20 H 19 V 12 H 22 L 11, 2 L 0,12 H 3 V 20 Z"/>
                            </Button>

                            <Border Grid.Column="1" BorderThickness="1"
                                    Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">
                              
                                <Border.Style>
                                    <Style TargetType="{x:Type Border}">
                                        <Setter Property="BorderBrush" Value="{DynamicResource NotActiveBorderBrush}"/>

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=IsChecked, ElementName=togglePath}" Value="True">
                                                <Setter Property="BorderBrush" Value="{DynamicResource {x:Static SystemColors.HighlightBrushKey}}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>

                                <Grid>
                                    <ProgressBar x:Name="progressBar" Panel.ZIndex="1" Background="Transparent" BorderThickness="0"
                                                 Foreground="{DynamicResource {x:Static SystemColors.HotTrackBrushKey}}"
                                                 Minimum="0" Maximum="100" IsIndeterminate="True" 
                                                 Value="{Binding ElementName=BreadcrumbControl, Path=Progress}">
                                        <ProgressBar.Style>
                                            <Style TargetType="{x:Type ProgressBar}">
                                                <Setter Property="Visibility" Value="Hidden"/>

                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=IsProgress, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}" Value="True">
                                                        <Setter Property="Visibility" Value="Visible"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ProgressBar.Style>
                                    </ProgressBar>

                                    <Grid>
                                        <Grid.Style>
                                            <Style TargetType="{x:Type Grid}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=Visibility, ElementName=progressBar}" Value="Visible">
                                                        <Setter Property="IsEnabled" Value="False"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Grid.Style>

                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <ToggleButton x:Name="togglePath" Grid.Column="0" IsChecked="False" Padding="0" Margin="0"
                                                  Focusable="False" Background="Transparent" BorderThickness="0"
                                                  Width="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}">

                                            <!--<Path Fill="Black"
                                                  Data="M26.523841796875 2.476158203125H2.476158203125C1.268738671875 2.4761015625000002 0.29 3.454885546875 0.29 4.662305078125v19.67538984375c0 1.207408203125 0.9787386718750001 2.186203515625 2.186158203125 2.186146875h24.047683593749998c1.207340234375 -0.0000453125 2.186158203125 -0.9788066406249999 2.186158203125 -2.186146875V4.662305078125c0 -1.20737421875 -0.97877265625 -2.186146875 -2.186158203125 -2.186146875Zm-12.43375 12.877812500000001 -5.465378515625 4.372305078125c-0.657382421875 0.525908203125 -1.637559765625 0.1429609375 -1.764321484375 -0.689305078125 -0.058826953125 -0.386255078125 0.09287929687499999 -0.7745605468750001 0.397968359375 -1.0186250000000001L11.656629296875 14.5 7.258360156250001 10.981654296875c-0.657382421875 -0.525908203125 -0.4989359375 -1.566237890625 0.285208203125 -1.872595703125 0.363916015625 -0.142179296875 0.776055859375 -0.07941015624999999 1.081144921875 0.164665625l5.465378515625 4.372305078125c0.547680859375 0.43759414062499996 0.547680859375 1.270347265625 0 1.70794140625Zm6.968371484375 4.611419140625h-5.465389843750001c-0.841441796875 -0.0000453125 -1.3673613281249999 -0.9109625000000001 -0.9466007812499999 -1.6396667968749998 0.195262890625 -0.33816718749999997 0.556108984375 -0.54649140625 0.9466007812499999 -0.54649140625h5.465389843750001c0.841453125 0 1.3673613281249999 0.9108945312500001 0.946634765625 1.63961015625 -0.1952515625 0.33818984375 -0.556131640625 0.5465253906249999 -0.946634765625 0.546548046875Z"/>-->


                                            <Path Fill="#FFCB42"
                                                  Data="M22.035416666666666 8.881458333333333C22.496145833333333 8.881458333333333 22.93885416666667 8.950208333333334 23.354895833333334 9.076875000000001V8.881458333333333C23.354895833333334 6.883020833333334 21.734895833333336 5.263020833333334 19.736458333333335 5.263020833333334H15.057708333333334C14.8178125 5.2628125 14.587916666666668 5.167291666666667 14.4184375 4.997604166666667L11.860104166666668 2.4405208333333337C11.351354166666667 1.9311458333333336 10.661041666666668 1.6447916666666667 9.941145833333334 1.6444791666666667H5.262395833333334C3.2639583333333335 1.6444791666666667 1.6438541666666668 3.264479166666667 1.6438541666666668 5.2629166666666665V9.076875000000001C2.0716666666666668 8.946979166666667 2.516354166666667 8.881145833333335 2.9634375000000004 8.881458333333333H22.035416666666666ZM2.9634375000000004 10.690729166666667C1.3121875 10.691041666666669 0.043854166666666666 12.153541666666667 0.27729166666666666 13.78822916666667L1.3109375 21.025208333333335C1.5017708333333335 22.362083333333334 2.646666666666667 23.3553125 3.9970833333333338 23.355520833333333H21.002916666666668C22.353333333333335 23.3553125 23.49822916666667 22.362083333333334 23.6890625 21.025208333333335L24.722708333333333 13.78822916666667C24.956145833333334 12.153541666666667 23.687812500000003 10.691041666666669 22.036562500000002 10.690729166666667H2.9634375000000004Z"/>
                                        </ToggleButton>

                                        <ContentControl Grid.Column="1">
                                            <ContentControl.Style>
                                                <Style TargetType="{x:Type ContentControl}">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="{x:Type ContentControl}">
                                                                <ListBox x:Name="listBoxFolders" Margin="0" Padding="-8, 0, 0, 0"
                                                                         Background="Transparent" BorderBrush="Transparent" BorderThickness="0"
                                                                         HorizontalAlignment="Stretch" HorizontalContentAlignment="Left"
                                                                         ScrollViewer.HorizontalScrollBarVisibility="Hidden" ScrollViewer.VerticalScrollBarVisibility="Hidden"
                                                                         ItemsSource="{Binding Path=FoldersCollection, Mode=OneWay, UpdateSourceTrigger=PropertyChanged,
                                                                                       RelativeSource={RelativeSource AncestorType={x:Type ComboBox}, Mode=FindAncestor}}"
                                                                         Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}"
                                                                         SelectedItem="{Binding Path=SelectedFolder, Mode=OneWayToSource, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">

                                                                    <ListBox.ItemContainerStyle>
                                                                        <Style TargetType="{x:Type ListBoxItem}">
                                                                            <Setter Property="Template" Value="{StaticResource listBoxItemTemplate}"/>
                                                                        </Style>
                                                                    </ListBox.ItemContainerStyle>                                                                   

                                                                    <ListBox.ItemsPanel>
                                                                        <ItemsPanelTemplate>
                                                                            <StackPanel Margin="8,0,0,0" Orientation="Horizontal"></StackPanel>
                                                                        </ItemsPanelTemplate>
                                                                    </ListBox.ItemsPanel>
                                                                </ListBox>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>

                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=IsChecked, ElementName=togglePath}" Value="True">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="{x:Type ContentControl}">
                                                                        <TextBox x:Name="textBoxFullPath"
                                                                                 Text="{Binding Path=Directory, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, 
                                                                                    RelativeSource={RelativeSource AncestorType={x:Type ComboBox}, Mode=FindAncestor}}"
                                                                                 VerticalContentAlignment="Center" HorizontalContentAlignment="Left"/>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ContentControl.Style>
                                        </ContentControl>
                                    </Grid>
                                </Grid>
                            </Border>

                            <Button Grid.Column="2" BorderBrush="{StaticResource NotActiveBorderBrush}" ToolTip="Обновить дерево файлов"
                                    Width="Auto" Margin="0" Padding="5"
                                    Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type StackPanel}, Mode=FindAncestor}}"
                                    Template="{StaticResource buttonTemplate}"
                                    Command="{Binding Path=UpDateCommand, RelativeSource={RelativeSource AncestorType={x:Type local:Breadcrumb}, Mode=FindAncestor}}">

                                <Path Style="{StaticResource IconStyle}"
                                      Data="M 10,3 H 4 L 6,5 A 12,12 180 1,0 17,3 C 17,3 16,3 16,6 A 9,9 180 1,1 8.5,7 L 11,9 V 3 Z"/>
                            </Button>

                            <!--<Button Grid.Column="3" BorderBrush="{StaticResource NotActiveBorderBrush}"
                                    Width="Auto" Margin="0" Padding="5"
                                    Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type StackPanel}, Mode=FindAncestor}}"
                                    Template="{StaticResource buttonTemplate}">

                                <Border>
                                    <Path Fill="BlanchedAlmond" Stroke="Aqua"
                                      Data="M 21,11 C 21,16.55 17.16,21.74 12,23 C 6.84,21.74 3,16.55 3,11 V 5 L 12,1 L 21,5 V 11 
                                      M12,21C15.75,20 19,15.54 19,11.22V6.3L12,3.18L5,6.3V11.22C5,15.54 8.25,20 12,21M12,6A3,3 0 0,1 15,9C15,10.31 14.17,11.42 13,11.83V14H15V16H13V18H11V11.83C9.83,11.42 9,10.31 9,9A3,3 0 0,1 12,6M12,8A1,1 0 0,0 11,9A1,1 0 0,0 12,10A1,1 0 0,0 13,9A1,1 0 0,0 12,8Z"/>
                                </Border>
                            </Button>-->

                            <!--<Button Grid.Column="4" BorderBrush="{StaticResource NotActiveBorderBrush}"
                                    Width="Auto" Margin="0" Padding="5"
                                    Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type StackPanel}, Mode=FindAncestor}}"
                                    Template="{StaticResource buttonTemplate}">

                                <Grid>
                                    --><!--<Path Fill="BlanchedAlmond" Stroke="Aqua"
                                      Data="M 0,2 C 0,1 0.5,0 2,0 H 5 L 7,2 Z"/>--><!--

                                    <Path Fill="#FFCB42"
                                      Data="M26.523841796875 6.84846328125H14.952264062500001l-3.7314957031250002 -3.731484375c-0.40874140625 -0.411584765625 -0.9652695312500001 -0.6423726562500001 -1.5453375 -0.6408207031250001H2.476158203125C1.268738671875 2.4761015625000002 0.29 3.454896875 0.29 4.6623164062499995v19.760090234375c0.0022542968750000002 1.160192578125 0.94261328125 2.09993984375 2.102805859375 2.101446484375H26.64544921875c1.139598046875 -0.001506640625 2.063044140625 -0.924952734375 2.0645507812500004 -2.0645507812500004V9.034621484375c0 -1.207340234375 -0.9788179687499999 -2.1861015624999998 -2.186158203125 -2.186158203125ZM2.476158203125 4.6623164062499995h7.19927265625l2.186158203125 2.186146875H2.476158203125Z"/>
                                </Grid>
                            </Button>-->
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </ComboBox.Style>
</ComboBox>
