<Page x:Class="ForRobot.Views.Pages.PageMain2"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:ForRobot.Views.Pages"
      xmlns:vm="clr-namespace:ForRobot.ViewModels"
      xmlns:lib="clr-namespace:ForRobot.Libr"
      xmlns:client="clr-namespace:ForRobot.Libr.Client"
      xmlns:model="clr-namespace:ForRobot.Model"
      xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
      xmlns:sys="clr-namespace:System;assembly=mscorlib"
      xmlns:control="clr-namespace:ForRobot.Views.Controls"
      xmlns:properties="clr-namespace:ForRobot.Properties"
      xmlns:nlog="clr-namespace:NLog;assembly=NLog"
      mc:Ignorable="d" 
      d:DesignHeight="800" d:DesignWidth="1500"
      Background="#cfcfcf">

    <Page.DataContext>
        <vm:MainPageViewModel2/>
    </Page.DataContext>

    <Page.Title>
        <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Интерфейс - v.{0}">
            <Binding Path="Version" Mode="OneWay"/>
        </MultiBinding>
    </Page.Title>

    <Page.Resources>
        <ControlTemplate x:Key="toggleButtonTemplate" TargetType="{x:Type ToggleButton}">
            <Border Name="buttonPanel" BorderThickness="0" CornerRadius="5">
                <ContentPresenter x:Name="buttonContent"
                                  VerticalAlignment="Center" HorizontalAlignment="Center"
                                  ContentSource="Content"
                                  Margin="{Binding Padding, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}"/>

                <Border.Style>
                    <Style TargetType="{x:Type Border}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}" Value="True">
                                <Setter Property="Background" Value="{StaticResource BrushLightGray}"/>
                            </DataTrigger>

                            <DataTrigger Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}" Value="True">
                                <Setter Property="Background" Value="{StaticResource BrushAqua}"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
            </Border>
        </ControlTemplate>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="25"/>
        </Grid.RowDefinitions>

        <Menu Grid.Row="0">
            <Menu.ItemsPanel>
                <ItemsPanelTemplate>
                    <DockPanel HorizontalAlignment="Stretch"/>
                </ItemsPanelTemplate>
            </Menu.ItemsPanel>

            <MenuItem>
                <MenuItem.Template>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <ComboBox FontSize="18" VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                                  Width="Auto" MinWidth="200" Margin="42,10,10,10"
                                  ItemsSource="{Binding Path=RobotNamesCollection, Mode=OneWay}"
                                  SelectedItem="{Binding Path=SelectedNameRobot, Mode=TwoWay}"
                                  SelectedIndex="0">

                            <ComboBox.Style>
                                <Style TargetType="{x:Type ComboBox}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=RobotsCollection.Count}" Value="0">
                                            <Setter Property="IsEnabled" Value="False"/>
                                            <Setter Property="IsEditable" Value="True"/>
                                            <Setter Property="Text" Value="Нет введёных роботов"/>
                                        </DataTrigger>

                                        <DataTrigger Binding="{Binding Path=SelectedNameRobot}" Value="{x:Null}">
                                            <Setter Property="SelectedIndex" Value="0"/>
                                        </DataTrigger>

                                        <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                            <Setter Property="Visibility" Value="Hidden"/>
                                            <Setter Property="Height" Value="0"/>
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBox.Style>

                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="{x:Type ComboBoxItem}">
                                    <Setter Property="Height" Value="45"/>
                                    <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                                    <Setter Property="TextBlock.VerticalAlignment" Value="Center"/>
                                </Style>
                            </ComboBox.ItemContainerStyle>
                        </ComboBox>
                    </ControlTemplate>
                </MenuItem.Template>
            </MenuItem>

            <MenuItem Margin="5,0">
                <MenuItem.Template>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <control:SliderButton IsChecked="{Binding Path=SendingGeneratedFiles, FallbackValue=True, Mode=TwoWay}"
                                              ToolTip="Отправка на робота после генерации">
                            <control:SliderButton.Style>
                                <Style TargetType="{x:Type control:SliderButton}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                            Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                            <Setter Property="Visibility" Value="Hidden"/>
                                            <Setter Property="Height" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </control:SliderButton.Style>
                        </control:SliderButton>
                    </ControlTemplate>
                </MenuItem.Template>
            </MenuItem>

            <MenuItem Padding="5" Margin="5,0">
                <MenuItem.Template>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Button Grid.Column="1" Height="50" Padding="5" Margin="5, 0" ToolTip="Генерация программ"
                                HorizontalAlignment="Left" VerticalAlignment="Center" Visibility="Visible" 
                                Template="{StaticResource buttonTemplate}">

                            <Image Stretch="Fill">
                                <Image.Style>
                                    <Style TargetType="Image">
                                        <Setter Property="Source" Value="{StaticResource ImageGenerationOff}"/>

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=IsMouseOver, RelativeSource={RelativeSource AncestorType={x:Type Button}, Mode=FindAncestor}}" Value="True">
                                                <Setter Property="Source" Value="{StaticResource ImageGenerationOn}"/>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=IsPressed, RelativeSource={RelativeSource AncestorType={x:Type Button}, Mode=FindAncestor}}" Value="True">
                                                <Setter Property="Source" Value="{StaticResource ImageGenerationOn}"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Image.Style>
                            </Image>

                            <Button.Style>
                                <Style TargetType="{x:Type Button}" BasedOn="{StaticResource buttonBaseStyle}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=RobotsCollection.Count}" Value="0">
                                            <Setter Property="IsEnabled" Value="False"/>
                                        </DataTrigger>

                                        <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                            <Setter Property="IsEnabled" Value="False"/>
                                        </DataTrigger>

                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter Property="FocusManager.FocusedElement" Value="{Binding RelativeSource={RelativeSource Mode=Self}}"/>
                                        </Trigger>

                                        <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                            <Setter Property="Visibility" Value="Hidden"/>
                                            <Setter Property="Height" Value="0"/>
                                            <Setter Property="Width" Value="0"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>

                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Click">
                                    <i:InvokeCommandAction Command="{Binding Path=GenerateProgramCommandAsync}" CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"/>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </Button>
                    </ControlTemplate>
                </MenuItem.Template>
            </MenuItem>

            <!--<MenuItem>
                <MenuItem.Template>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <ToolBarTray>
                            <ToolBar Width="Auto" Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToolBarTray}, Mode=FindAncestor}}" OverflowMode="Never">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <ToggleButton Grid.Column="0" Name="toggleButtonProgrammControl" Height="50" Padding="5" Margin="5,0"
                                                  IsChecked="True" VerticalAlignment="Center"
                                                  Template="{StaticResource toggleButtonTemplate}">

                                        <Path Stretch="Fill" StrokeThickness="3"
                                             Data="M7 8L3 11.6923L7 16M17 8L21 11.6923L17 16M14 4L10 20">

                                            <Path.Style>
                                                <Style TargetType="{x:Type Path}">
                                                    <Setter Property="Stroke" Value="Black"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=IsChecked, RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}" Value="True">
                                                            <Setter Property="Stroke" Value="#FF1BFFCB"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Path.Style>
                                        </Path>

                                        <ToggleButton.Style>
                                            <Style TargetType="{x:Type ToggleButton}" BasedOn="{StaticResource buttonBaseStyle}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=RobotsCollection.Count}" Value="0">
                                                        <Setter Property="IsChecked" Value="False"/>
                                                        <Setter Property="IsEnabled" Value="False"/>
                                                    </DataTrigger>

                                                    <DataTrigger Binding="{Binding Path=RobotForControl.IsConnection}" Value="{StaticResource False}">
                                                        <Setter Property="IsChecked" Value="False"/>
                                                        <Setter Property="IsEnabled" Value="False"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </ToggleButton.Style>

                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Checked">
                                                <i:InvokeCommandAction Command="{Binding Path=OpenCodingCommand}" CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type ToggleButton}, Mode=FindAncestor}}"/>
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ToggleButton>

                                    <Border Grid.Column="1" Margin="3" BorderThickness="0">
                                        <Border.Resources>
                                            <Style TargetType="{x:Type Label}">
                                                <Setter Property="FontSize" Value="18"/>
                                                <Setter Property="FontFamily" Value="Segoe UI Historic"/>
                                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                                                <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            </Style>
                                        </Border.Resources>
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ElementName=toggleButtonProgrammControl, Path=IsChecked}" Value="False">
                                                        <Setter Property="Width" Value="0"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <Button Grid.Column="0" Height="45"
                                                    Template="{StaticResource buttonTemplate}">
                                                <Button.Style>
                                                    <Style TargetType="{x:Type Button}">
                                                        <Setter Property="Margin" Value="5, 0"/>
                                                        <Setter Property="ToolTip" Value="Запуск программы"/>
                                                        <Setter Property="Command" Value="{Binding Path=RunProgramCommandAsync}"/>
                                                        <Setter Property="Content">
                                                            <Setter.Value>
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                    </Grid.ColumnDefinitions>

                                                                    <Border Grid.Column="0" Padding="5">
                                                                        <Path Fill="#FF26D300" Stretch="Uniform">
                                                                            <Path.Data>
                                                                                <GeometryGroup>
                                                                                    <PathGeometry Figures="M810.666667 896H213.333333c-46.933333 0-85.333333-38.4-85.333333-85.333333V213.333333c0-46.933333 38.4-85.333333 85.333333-85.333333h597.333334c46.933333 0 85.333333 38.4 85.333333 85.333333v597.333334c0 46.933333-38.4 85.333333-85.333333 85.333333z"/>
                                                                                    <PathGeometry Figures="M661.333333 512l-234.666666-170.666667v341.333334z"/>
                                                                                </GeometryGroup>
                                                                            </Path.Data>
                                                                        </Path>
                                                                    </Border>

                                                                    <Label Grid.Column="1" Content="Пуск"/>
                                                                </Grid>
                                                            </Setter.Value>
                                                        </Setter>
                                                        
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=RobotForControl.Pro_State}" Value="#P_ACTIVE">
                                                                <Setter Property="Width" Value="0"/>
                                                                <Setter Property="Margin" Value="0"/>
                                                            </DataTrigger>

                                                            <DataTrigger Binding="{Binding Path=RobotForControl.Pro_State}" Value="#P_STOP">
                                                                <Setter Property="ToolTip" Value="Продолжить программу"/>
                                                                <Setter Property="Content">
                                                                    <Setter.Value>
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                            </Grid.ColumnDefinitions>

                                                                            <Border Grid.Column="0" Padding="5">
                                                                                <Path Fill="#FF26D300" Stretch="Uniform">
                                                                                    <Path.Data>
                                                                                        <GeometryGroup>
                                                                                            <PathGeometry Figures="M810.666667 896H213.333333c-46.933333 0-85.333333-38.4-85.333333-85.333333V213.333333c0-46.933333 38.4-85.333333 85.333333-85.333333h597.333334c46.933333 0 85.333333 38.4 85.333333 85.333333v597.333334c0 46.933333-38.4 85.333333-85.333333 85.333333z"/>
                                                                                            <PathGeometry Figures="M661.333333 512l-234.666666-170.666667v341.333334z"/>
                                                                                        </GeometryGroup>
                                                                                    </Path.Data>
                                                                                </Path>
                                                                            </Border>
                                                                            
                                                                            <Label Grid.Column="1" Content="Продолжить"/>
                                                                        </Grid>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </DataTrigger>

                                                            <DataTrigger Binding="{Binding Path=RobotForControl.Pro_State}" Value="#P_END">
                                                                <Setter Property="ToolTip" Value="Перезапуск программы"/>
                                                                <Setter Property="Content">
                                                                    <Setter.Value>
                                                                        <Grid>
                                                                            <Grid.ColumnDefinitions>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                                <ColumnDefinition Width="Auto"/>
                                                                            </Grid.ColumnDefinitions>

                                                                            <Border Grid.Column="0" Padding="5">
                                                                                <Path Fill="#3b88c3" Stretch="Uniform">
                                                                                    <Path.Data>
                                                                                        <GeometryGroup>
                                                                                            <PathGeometry Figures="M36 32a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v28z"/>
                                                                                            <PathGeometry Figures="M30.2 10L23 4v4h-8C9.477 8 5 12.477 5 18c0 1.414.297 2.758.827 3.978l3.3-2.75A6 6 0 0 1 15 12h8v4l7.2-6zm-.026 4.023l-3.301 2.75A6 6 0 0 1 21 24h-8v-4l-7.2 6l7.2 6v-4h8c5.522 0 10-4.478 10-10a9.965 9.965 0 0 0-.826-3.977z"/>
                                                                                        </GeometryGroup>
                                                                                    </Path.Data>
                                                                                </Path>
                                                                            </Border>

                                                                            <Label Grid.Column="1" Content="Перезапустить"/>
                                                                        </Grid>
                                                                    </Setter.Value>
                                                                </Setter>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>

                                            <Button Grid.Column="1" Height="45" 
                                                    Template="{StaticResource buttonTemplate}">
                                                <Button.Style>
                                                    <Style TargetType="{x:Type Button}">
                                                        <Setter Property="Width" Value="0"/>
                                                        <Setter Property="Margin" Value="0"/>
                                                        <Setter Property="ToolTip" Value="Остановка программы"/>
                                                        <Setter Property="Command" Value="{Binding Path=PauseProgramCommandAsync}"/>

                                                        <Setter Property="Content">
                                                            <Setter.Value>
                                                                <Grid>
                                                                    <Grid.ColumnDefinitions>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                        <ColumnDefinition Width="Auto"/>
                                                                    </Grid.ColumnDefinitions>

                                                                    <Border Grid.Column="0" Padding="5">
                                                                        <Path Fill="Red" Stretch="Uniform">
                                                                            <Path.Data>
                                                                                <GeometryGroup>
                                                                                    <PathGeometry Figures="M36 32a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v28z"/>
                                                                                    <PathGeometry Figures="M20 7h5v22h-5zm-9 0h5v22h-5z"/>
                                                                                </GeometryGroup>
                                                                            </Path.Data>
                                                                        </Path>
                                                                    </Border>

                                                                    <Label Grid.Column="1" Content="Остановить"/>
                                                                </Grid>
                                                            </Setter.Value>
                                                        </Setter>

                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=RobotForControl.Pro_State}" Value="#P_ACTIVE">
                                                                <Setter Property="Width" Value="Auto"/>
                                                                <Setter Property="Margin" Value="5, 0"/>
                                                            </DataTrigger>

                                                            <DataTrigger Binding="{Binding Path=SelectedNameRobot}" Value="Все">
                                                                <Setter Property="Width" Value="Auto"/>
                                                                <Setter Property="Margin" Value="5, 0"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Button.Style>
                                            </Button>

                                            <Button Grid.Column="2" Height="45" ToolTip="Аннулировать программу"
                                                    Template="{StaticResource buttonTemplate}"
                                                    Command="{Binding CancelProgramCommandAsync}">

                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <Border Grid.Column="0" Padding="5">
                                                        <Path Fill="Red" Stretch="Uniform">
                                                            <Path.Data>
                                                                <GeometryGroup>
                                                                    <PathGeometry Figures="M36 32a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v28z"/>
                                                                    <PathGeometry Figures="M 15 12 a 2 2 0 0 0-2 2 v 8 a 2 2 0 0 0 2 2 h 8 a2 2 0 0 0 2-2 V 14 a 2 2 0 0 0-2-2 H 13Z"/>
                                                                </GeometryGroup>
                                                            </Path.Data>
                                                        </Path>
                                                    </Border>

                                                    <Label Grid.Column="1" Content="Аннулировать"/>
                                                </Grid>
                                            </Button>

                                            <Button Grid.Column="3" Height="45"
                                                    ToolTip="Выбор сгенерированной программы" 
                                                    Template="{StaticResource buttonTemplate}"
                                                    Command="{Binding Path=SelectGeneratProgramCommandAsync}">

                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="45"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>

                                                    <Border Grid.Column="0" Padding="5">
                                                        <Path Fill="#FF008AD8" Stretch="Fill" 
                                                              Data="M18,7a1,1,0,0,0-1-1H7A1,1,0,0,0,6,7V17a1,1,0,0,0,1,1H17a1,1,0,0,0,1-1Zm-2,9H8V8h8ZM13,2V4H11V2Zm5,2H16V2h2ZM8,4H6V2H8ZM4,2,2,4V2ZM22,4,20,2h2ZM11,22V20h2v2Zm5-2h2v2H16ZM6,20H8v2H6Zm16-7H20V11h2Zm0,5H20V16h2ZM22,8H20V6h2ZM4,13H2V11H4Zm0,5H2V16H4ZM4,8H2V6H4ZM2,20l2,2H2Zm18,2,2-2v2Z"/>
                                                    </Border>

                                                    <Label Grid.Column="1" Content="Выбрать"/>
                                                </Grid>
                                            </Button>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </ToolBar>
                        </ToolBarTray>
                    </ControlTemplate>
                </MenuItem.Template>
            </MenuItem>-->

            <MenuItem>
                <MenuItem.Template>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <ToolBarTray>
                            <ToolBar Width="Auto" Height="{Binding Path=ActualHeight, RelativeSource={RelativeSource AncestorType={x:Type ToolBarTray}, Mode=FindAncestor}}" OverflowMode="Never">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Button Grid.Column="0" Padding="5" Margin="5, 0" 
                                            ToolTip="Импортировать параметры"
                                            Template="{StaticResource buttonTemplate}"
                                            Command="{Binding ImportCommand}">

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <Path Fill="Black" Stroke="{x:Null}" Stretch="Fill"
                                                      SnapsToDevicePixels="False" UseLayoutRounding="False"
                                                  Data="M19.5 0v23.378700000000002l3.43935 -3.43935 2.1212999999999997 2.1212999999999997 -6 6c-0.58575 0.58575 -1.5355500000000002 0.58575 -2.1212999999999997 0l-6.000014999999999 -6 2.12133 -2.1212999999999997L16.5 23.378700000000002V0h3Zm10.5 36c0.82845 0 1.5 -0.67155 1.5 -1.5l0 -21c0 -0.8284349999999999 -0.67155 -1.5 -1.5 -1.5h-6v3h4.5l0 18 -21 0 0 -18h4.5l0 -3H6c-0.8284199999999999 0 -1.5 0.6715800000000001 -1.5 1.5l0 21c0 0.82845 0.6715800000000001 1.5 1.5 1.5l24 0Z"/>
                                            </StackPanel>

                                            <Label Grid.Column="1" Content="Импорт" FontSize="18" FontFamily="Segoe UI Historic" VerticalContentAlignment="Center" HorizontalContentAlignment="Left"/>
                                        </Grid>
                                    </Button>

                                    <Button Grid.Column="1" Padding="5" Margin="5, 0"
                                            ToolTip="Экспортировать параметры" 
                                            Template="{StaticResource buttonTemplate}"
                                            Command="{Binding ExportCommand}">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>

                                            <StackPanel Grid.Column="0">
                                                <Path Fill="Black" Stroke="{x:Null}" Stretch="Fill"
                                                      SnapsToDevicePixels="False" UseLayoutRounding="False"
                                                      Data="M 32.1 16.2 v 15.2 c 0 1.8 -1.4 3.2 -3.2 3.2 H 6 c -1.8 0 -3.2 -1.4 -3.2 -3.2 V 16.2 c 0 -1.8 1.4 -3.2 3.2 -3.2 h 3.2 c 1.5 0 2.4 1.6 1.6 2.9 -0.3 0.6 -1 1 -2 1 H 6.7 v13.973462890625h21.59535546875V16.86559765625h-2.5406308593749998c-1.466828125 -0.001244140625 -2.382255859375 -1.5899160156249998 -1.64776171875 -2.8596093750000002 0.34029296875 -0.5882734375 0.9681601562500001 -0.9507558593750001 1.64776171875 -0.95134375h3.17578515625c1.7538828125 0.00008203124999999999 3.17578515625 1.421916015625 3.17578515625 3.175798828125ZM12.496544921875 9.956666015625l3.0979785156250004 -3.094806640625v13.179523437499999c0.001244140625 1.466828125 1.5899160156249998 2.382255859375 2.8596093750000002 1.64776171875 0.5882734375 -0.340306640625 0.95076953125 -0.9681601562500001 0.95134375 -1.64776171875V6.861859375l3.0979785156250004 3.099578125c1.0390078125 1.0390078125 2.813138671875 0.563623046875 3.19344921875 -0.8556816406250001 0.176490234375 -0.6587109375 -0.011826171875 -1.361541015625 -0.49403320312500004 -1.843734375L18.85130078125 0.9104375c-0.744666015625 -0.7472500000000001 -1.954763671875 -0.7472500000000001 -2.6994160156249998 0L9.80030078125 7.262021484375c-1.0390078125 1.038994140625 -0.563623046875 2.813138671875 0.8556816406250001 3.193435546875 0.6587109375 0.17650390624999998 1.361541015625 -0.0118125 1.843748046875 -0.49401953125 Z"/>
                                            </StackPanel>

                                            <Label Grid.Column="1" Content="Экспорт" FontSize="18" FontFamily="Segoe UI Historic" VerticalContentAlignment="Center" HorizontalContentAlignment="Left"/>
                                        </Grid>
                                    </Button>
                                </Grid>

                                <ToolBar.Style>
                                    <Style TargetType="{x:Type ToolBar}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                                <Setter Property="Visibility" Value="Hidden"/>
                                                <Setter Property="Width" Value="0"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ToolBar.Style>
                            </ToolBar>
                        </ToolBarTray>
                    </ControlTemplate>
                </MenuItem.Template>
            </MenuItem>

            <MenuItem HorizontalAlignment="Right" Padding="5" Margin="5,0">
                <MenuItem.Template>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <StackPanel Orientation="Horizontal">
                            <Button Padding="5" ToolTip="Значения по-умолчанию" Margin="15,0"                                    
                                    Template="{StaticResource buttonTemplate}"
                                    Command="{Binding Path=StandartParametrsCommand}">

                                <Path Fill="Black" Stroke="{x:Null}" Stretch="Fill"
                                      SnapsToDevicePixels="False" UseLayoutRounding="False"
                                      RenderTransformOrigin="0.5,0.5"
                                      Data="M 15.298584,13.523026 c -4.613353,2.663522 -6.2057583,8.523663 -3.542235,13.137021 L 32.2105,62.087675 15.73009,71.602643 c -4.613351,2.66352 -6.179518,8.508509 -3.515995,13.12187 l 5.590806,9.683546 8.030255,-4.636274 c 3.182028,4.61497 7.29038,10.526885 11.002687,15.481515 2.787941,3.72093 3.857273,6.61875 7.090695,8.88757 1.616725,1.13441 3.794622,1.70014 5.90823,1.62748 2.113617,-0.0726 4.282409,-0.60361 7.025804,-1.46707 a 3.8791009,3.8791009 0 0 0 0.43907,-0.14858 L 104.38087,92.849844 c 2.9438,-1.331203 5.3043,-2.305167 7.09395,-3.045982 1.78964,-0.740815 2.70318,-0.945214 4.13337,-1.931531 0.35752,-0.246609 0.85866,-0.466406 1.46226,-1.649016 0.30181,-0.59129 0.59552,-1.568881 0.40197,-2.576425 -0.19354,-1.007545 -0.81444,-1.802109 -1.28785,-2.230629 -0.94684,-0.85704 -1.46482,-0.903323 -1.88005,-1.013963 -0.41522,-0.110641 -0.72628,-0.151726 -1.05703,-0.194498 -1.32302,-0.171071 -2.91538,-0.196661 -5.32735,-0.318317 L 95.758248,79.248303 C 92.896834,79.103976 88.82337,75.692473 86.636067,72.478348 L 77.953112,59.681415 83.070434,56.726926 77.479638,47.04338 c -2.663522,-4.613358 -8.534759,-6.164366 -13.14811,-3.500844 l -15.456943,8.92407 -20.45415,-35.427627 c -2.663522,-4.613358 -8.50852,-6.179516 -13.121871,-3.515994 z m 17.254707,72.370046 38.655476,-22.317751 9.023312,13.265242 c 2.978745,4.377118 7.96037,9.794061 15.13597,10.155974 l 2.778245,0.14549 -43.601942,19.750113 c -0.03161,0.0104 -0.03607,-0.006 -0.06759,0.004 -2.381656,0.74441 -4.040708,1.09309 -4.914999,1.12315 -0.885879,0.0305 -0.867183,-0.041 -1.154964,-0.24292 -0.575553,-0.40385 -2.220147,-2.97114 -5.357802,-7.15881 C 39.66876,96.105995 35.713996,90.464756 32.553339,85.892888 Z">
                                    <Path.RenderTransform>
                                        <ScaleTransform ScaleX="-1.0"/>
                                    </Path.RenderTransform>
                                </Path>

                                <Button.Style>
                                    <Style TargetType="{x:Type Button}" BasedOn="{StaticResource buttonBaseStyle}">
                                        <Setter Property="Height" Value="50"/>

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                                <Setter Property="Visibility" Value="Hidden"/>
                                                <Setter Property="Height" Value="0"/>
                                                <Setter Property="Width" Value="0"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>
                            </Button>

                            <!--<Separator HorizontalAlignment="Right" Margin="10">
                                <Separator.LayoutTransform>
                                    <RotateTransform Angle="90" />
                                </Separator.LayoutTransform>
                            </Separator>-->

                            <!--<RadioButton Content="One" Width="45" Margin="3,0" Style="{StaticResource toggleButtonCordinateStyle}"
                                         IsChecked="{Binding Path=PageNowString, Converter={StaticResource ResourceKey=RadioButtonConvert}, ConverterParameter=Page2D, Mode=TwoWay}">

                                <RadioButton.Template>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border BorderThickness="0" CornerRadius="5" Padding="2" Style="{StaticResource toggleButtonCordinateTemplateStyle}">
                                            <Image Source="{StaticResource Image2D}" Stretch="Fill"/>
                                        </Border>
                                    </ControlTemplate>
                                </RadioButton.Template>
                            </RadioButton>-->

                            <!--<RadioButton Content="Two" Width="45" Margin="3,0" Style="{StaticResource toggleButtonCordinateStyle}"
                                     IsChecked="{Binding Path=PageNowString, Converter={StaticResource ResourceKey=RadioButtonConvert}, ConverterParameter=Page3D, Mode=TwoWay}">

                                <RadioButton.Template>
                                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                                        <Border BorderThickness="0" CornerRadius="5" Padding="2" Style="{StaticResource toggleButtonCordinateTemplateStyle}">
                                            <Image Source="{StaticResource Image3D}"  Stretch="Fill"/>
                                        </Border>
                                    </ControlTemplate>
                                </RadioButton.Template>
                            </RadioButton>-->
                        </StackPanel>
                    </ControlTemplate>
                </MenuItem.Template>
            </MenuItem>
        </Menu>

        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition x:Name="leftColumn" Width="Auto" MinWidth="450"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition x:Name="rightColumn" Width="*"/>
            </Grid.ColumnDefinitions>

            <TabControl Grid.Column="0" TabStripPlacement="Left" Background="Transparent"
                        SelectedItem="{Binding Path=SelectedMainItem, Mode=TwoWay}">
                
                <TabControl.Resources>
                    <Style x:Key="tabItemBase" TargetType="{x:Type TabItem}">
                        <Setter Property="Padding" Value="3"/>
                        <Setter Property="FontSize" Value="15"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Height" Value="Auto"/>

                        <Setter Property="HeaderTemplate">
                            <Setter.Value>
                                <DataTemplate>
                                    <ContentPresenter Content="{TemplateBinding Content}" Margin="0,5">
                                        <ContentPresenter.LayoutTransform>
                                            <RotateTransform Angle="90" />
                                        </ContentPresenter.LayoutTransform>
                                    </ContentPresenter>
                                </DataTemplate>
                            </Setter.Value>
                        </Setter>

                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="TabItem">
                                    <Grid Name="Panel">
                                        <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header" Margin="10, 5"/>
                                    </Grid>

                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter TargetName="Panel" Property="Background" Value="LightSkyBlue"/>
                                            <Setter TargetName="ContentSite" Property="TextElement.FontWeight" Value="DemiBold"/>
                                        </Trigger>

                                        <Trigger Property="IsSelected" Value="False">
                                            <Setter TargetName="Panel" Property="Background" Value="Transparent"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>

                        <!--Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert},
                                             ConverterParameter='Binding .Header'}"-->

                        <!--<Style.Triggers>
                            <DataTrigger Value="False"
                                         Binding="{Binding Path=Header, Converter={StaticResource CollectionsStringToBoolConvert},
                                ConverterParameter=Settings.AvailableTab, Source={x:Static Application.Current}}">
                                --><!--<DataTrigger.Binding>
                                    <Binding Path="Settings.AvailableTab" Source="{x:Static Application.Current}" 
                                             Converter="{StaticResource CollectionsStringToBoolConvert}">
                                       
                                        --><!--<Binding.ConverterParameter>
                                            <Binding Path="Header" Mode="OneWay" RelativeSource="{RelativeSource AncestorType={x:Type TabItem}, Mode=FindAncestor}" Converter="{StaticResource StringConvert}" ConverterParameter=" {0} ">
                                                --><!--<Binding Path="Header" Mode="OneWay" RelativeSource="{RelativeSource AncestorType={x:Type TabItem}, Mode=FindAncestor}"/>--><!--
                                            </Binding>
                                        </Binding.ConverterParameter>--><!--
                                    </Binding>
                                </DataTrigger.Binding>--><!--
                                <Setter Property="Visibility" Value="Hidden"/>
                                <Setter Property="Height" Value="0"/>
                            </DataTrigger>
                        </Style.Triggers>-->
                    </Style>

                    <Style TargetType="{x:Type TabItem}" BasedOn="{StaticResource tabItemBase}"></Style>

                    <Style x:Key="textBlockBase" TargetType="{x:Type TextBlock}">
                        <Setter Property="Foreground" Value="Black"/>
                        <Setter Property="Padding" Value="5"/>
                        <Setter Property="TextWrapping" Value="NoWrap"/>
                        <Setter Property="VerticalAlignment" Value="Center"/>
                        <Setter Property="HorizontalAlignment" Value="Stretch"/>
                        <Setter Property="TextAlignment" Value="Center"/>
                    </Style>

                    <DataTemplate x:Key="buttonDelete">
                        <Button ToolTip="Удалить робота"
                                Width="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}"
                                Command="{Binding Path=DataContext.DeleteRobotCommand, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                CommandParameter="{Binding}">

                            <Path Stretch="Fill" Fill="Black"
                                      Data="M 10.6 34 c -0.7 0 -1.2 -0.2 -1.7 -0.7 -0.5 -0.5 -0.7 -1 -0.7 -1.7 V 8.5 H 7.7 c -0.3 0 -0.634700625 -0.11756875 -0.86815625 -0.352625C6.616861875 7.943812499999999 6.5 7.652669375 6.5 7.3051875c0 -0.34720562499999996 0.116861875 -0.635919375 0.35059375 -0.866125C7.084049375 6.208856875 7.3734375 6.09375 7.71875 6.09375h6.41875c0 -0.352080625 0.11683750000000001 -0.643231875 0.35059375 -0.8734375C14.721525 4.990106875 15.0109375 4.875 15.35625 4.875h8.2875c0.34531249999999997 0 0.63480625 0.116731875 0.8685624999999999 0.3501875 0.23343125 0.23373187499999998 0.3501875 0.52325 0.3501875 0.8685624999999999h6.41875c0.34531249999999997 0 0.63480625 0.11754437499999999 0.8685624999999999 0.352625 0.23343125 0.23481249999999998 0.3501875 0.5259556249999999 0.3501875 0.8734375 0 0.34720562499999996 -0.11675624999999999 0.635919375 -0.3501875 0.866125 -0.23375625 0.23018125 -0.52325 0.34531249999999997 -0.8685624999999999 0.34531249999999997h-0.446875V31.6875c0 0.6703125 -0.23863125000000002 1.2441 -0.7158125 1.72128125 -0.47750625 0.47750625 -1.051375 0.7162187499999999 -1.7216875000000003 0.7162187499999999h-17.79375Zm17.79375 -25.59375h-17.79375V31.6875h17.79375V8.53125ZM16.135437500000002 28.19375c0.34718125 0 0.6359437499999999 -0.11683750000000001 0.866125 -0.35059375 0.23018125 -0.23343125 0.34531249999999997 -0.5228437499999999 0.34531249999999997 -0.86815625V13.203125c0 -0.34531249999999997 -0.11756875 -0.63480625 -0.352625 -0.8685624999999999 -0.23481249999999998 -0.23343125 -0.52593125 -0.3501875 -0.8734375 -0.3501875 -0.34718125 0 -0.6359437499999999 0.11675624999999999 -0.866125 0.3501875 -0.23018125 0.23375625 -0.34531249999999997 0.52325 -0.34531249999999997 0.8685624999999999V26.975c0 0.34531249999999997 0.11756875 0.634725 0.352625 0.86815625 0.23481249999999998 0.23375625 0.52593125 0.35059375 0.8734375 0.35059375Zm6.74375 0c0.34718125 0 0.6359437499999999 -0.11683750000000001 0.866125 -0.35059375 0.23018125 -0.23343125 0.34531249999999997 -0.5228437499999999 0.34531249999999997 -0.86815625V13.203125c0 -0.34531249999999997 -0.11756875 -0.63480625 -0.352625 -0.8685624999999999 -0.23481249999999998 -0.23343125 -0.52593125 -0.3501875 -0.8734375 -0.3501875 -0.34718125 0 -0.6359437499999999 0.11675624999999999 -0.866125 0.3501875 -0.23018125 0.23375625 -0.34531249999999997 0.52325 -0.34531249999999997 0.8685624999999999V26.975c0 0.34531249999999997 0.11756875 0.634725 0.352625 0.86815625 0.23481249999999998 0.23375625 0.52593125 0.35059375 0.8734375 0.35059375Z"/>
                        </Button>
                    </DataTemplate>

                    <DataTemplate x:Key="buttonRename">
                        <Button ToolTip="Переименовать"
                                Width="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}"
                                Command="{Binding Path=DataContext.RenameRobotCommand, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                CommandParameter="{Binding}">

                            <Path Stretch="Fill" Fill="Black"
                                      Data="{StaticResource EditPathGeomerty}">
                                <Path.LayoutTransform>
                                    <RotateTransform Angle="90"/>
                                </Path.LayoutTransform>
                            </Path>
                        </Button>
                    </DataTemplate>

                    <DataTemplate x:Key="textBlockStatus">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <Ellipse Grid.Column="0" 
                                     Height="{Binding Path=ActualWidth, RelativeSource={RelativeSource Self}}"
                                     Width="{Binding Path=ActualWidth, RelativeSource={RelativeSource AncestorType={x:Type ColumnDefinition}, Mode=FindAncestor}}">

                                <Ellipse.Style>
                                    <Style TargetType="{x:Type Ellipse}">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_ACTIVE">
                                                <DataTrigger.EnterActions>
                                                    <BeginStoryboard x:Name="blinkAnimation">
                                                        <Storyboard>
                                                            <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" RepeatBehavior="Forever" AutoReverse="True" Duration="0:0:1.25"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </DataTrigger.EnterActions>

                                                <DataTrigger.ExitActions>
                                                    <StopStoryboard BeginStoryboardName="blinkAnimation"/>
                                                </DataTrigger.ExitActions>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>

                                <Ellipse.Fill>
                                    <RadialGradientBrush>
                                        <GradientStop Color="White" Offset="0"/>
                                        <GradientStop Color="{Binding Path=Foreground.Color, ElementName=statusString}" Offset="1"/>
                                    </RadialGradientBrush>
                                </Ellipse.Fill>
                            </Ellipse>

                            <TextBlock Grid.Column="1" x:Name="statusString" FontWeight="Bold"
                                       HorizontalAlignment="Left" TextAlignment="Left"
                                       Foreground="{Binding Path=Text, RelativeSource={RelativeSource Self}, Converter={StaticResource StatusColorConvert}}">

                                <TextBlock.Style>
                                    <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource textBlockBase}">
                                        <Setter Property="Text" Value="Нет соединения"/>
                                        <Setter Property="TextWrapping" Value="Wrap"/>

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_FREE">
                                                <Setter Property="Text" Value="Программа не выбрана"/>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_RESET">
                                                <Setter Property="Text">
                                                    <Setter.Value>
                                                        <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Выбрана программа {0}">
                                                            <Binding Path="RobotProgramName" Mode="OneWay"/>
                                                        </MultiBinding>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_ACTIVE">
                                                <Setter Property="Text">
                                                    <Setter.Value>
                                                        <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Запущена программа {0}">
                                                            <Binding Path="RobotProgramName" Mode="OneWay"/>
                                                        </MultiBinding>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_STOP">
                                                <Setter Property="Text">
                                                    <Setter.Value>
                                                        <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Программа {0} остановлена">
                                                            <Binding Path="RobotProgramName" Mode="OneWay"/>
                                                        </MultiBinding>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_END">
                                                <Setter Property="Text">
                                                    <Setter.Value>
                                                        <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Программа {0} завершена">
                                                            <Binding Path="RobotProgramName" Mode="OneWay"/>
                                                        </MultiBinding>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </DataTemplate>

                    <DataTemplate x:Key="robotControl">
                        <DataTemplate.Resources>
                            <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource textBlockBase}"></Style>
                        </DataTemplate.Resources>
                        
                        <WrapPanel Orientation="Horizontal" Margin="0, 5">
                            <Button Grid.Column="0">
                                <Button.Style>
                                    <Style TargetType="{x:Type Button}">
                                        <Setter Property="ToolTip" Value="Запуск программы"/>
                                        <Setter Property="Height" Value="45"/>
                                        <Setter Property="Background" Value="White"/>
                                        <Setter Property="Padding" Value="5"/>
                                        <Setter Property="Margin" Value="5"/>

                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_STOP">
                                                <Setter Property="ToolTip" Value="Продолжить выполнение программы"/>
                                            </DataTrigger>

                                            <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_END">
                                                <Setter Property="ToolTip" Value="Перезапуск программы"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Button.Style>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Path Grid.Column="0" Stretch="Uniform">
                                        <Path.Style>
                                            <Style TargetType="{x:Type Path}">
                                                <Setter Property="Fill" Value="#FF26D300"/>
                                                <Setter Property="Data">
                                                    <Setter.Value>
                                                        <GeometryGroup>
                                                            <PathGeometry Figures="M810.666667 896H213.333333c-46.933333 0-85.333333-38.4-85.333333-85.333333V213.333333c0-46.933333 38.4-85.333333 85.333333-85.333333h597.333334c46.933333 0 85.333333 38.4 85.333333 85.333333v597.333334c0 46.933333-38.4 85.333333-85.333333 85.333333z"/>
                                                            <PathGeometry Figures="M661.333333 512l-234.666666-170.666667v341.333334z"/>
                                                        </GeometryGroup>
                                                    </Setter.Value>
                                                </Setter>

                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_END">
                                                        <Setter Property="Fill" Value="#3b88c3"/>
                                                        <Setter Property="Data">
                                                            <Setter.Value>
                                                                <GeometryGroup>
                                                                    <PathGeometry Figures="M36 32a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v28z"/>
                                                                    <PathGeometry Figures="M30.2 10L23 4v4h-8C9.477 8 5 12.477 5 18c0 1.414.297 2.758.827 3.978l3.3-2.75A6 6 0 0 1 15 12h8v4l7.2-6zm-.026 4.023l-3.301 2.75A6 6 0 0 1 21 24h-8v-4l-7.2 6l7.2 6v-4h8c5.522 0 10-4.478 10-10a9.965 9.965 0 0 0-.826-3.977z"/>
                                                                </GeometryGroup>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Path.Style>
                                    </Path>

                                    <TextBlock Grid.Column="1">
                                        <TextBlock.Style>
                                            <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource textBlockBase}">
                                                <Setter Property="Text" Value="Пуск"/>

                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_STOP">
                                                        <Setter Property="Text" Value="Продолжить"/>
                                                    </DataTrigger>

                                                    <DataTrigger Binding="{Binding Path=Pro_State}" Value="#P_END">
                                                        <Setter Property="Text" Value="Перезапустить"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Grid>

                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="PreviewMouseDown">
                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.RunProgramCommandAsync, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                                               CommandParameter="{Binding}"/>
                                    </i:EventTrigger>

                                    <i:EventTrigger EventName="PreviewMouseUp">
                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.RetentionRunButtonCommandAsync, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                                               CommandParameter="{Binding}"/>
                                    </i:EventTrigger>

                                    <!--<i:EventTrigger EventName="Click">
                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.RunProgramCommandAsync, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                                               CommandParameter="{Binding}"/>
                                    </i:EventTrigger>-->

                                    <!--<i:EventTrigger EventName="MouseLeftButtonDown">
                                        <i:InvokeCommandAction Command="{Binding Path=DataContext.RetentionRunButtonCommandAsync, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                                               CommandParameter="{Binding}"/>
                                    </i:EventTrigger>-->
                                </i:Interaction.Triggers>
                            </Button>

                            <Button Grid.Column="1" ToolTip="Остановка программы"
                                    Command="{Binding Path=DataContext.PauseProgramCommandAsync, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                    CommandParameter="{Binding}">

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Path Fill="Red" Stretch="Uniform">
                                        <Path.Data>
                                            <GeometryGroup>
                                                <PathGeometry Figures="M36 32a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v28z"/>
                                                <PathGeometry Figures="M20 7h5v22h-5zm-9 0h5v22h-5z"/>
                                            </GeometryGroup>
                                        </Path.Data>
                                    </Path>

                                    <TextBlock Grid.Column="1" Text="Остановить"/>
                                </Grid>
                            </Button>

                            <Button Grid.Column="2" ToolTip="Аннулировать программу"
                                    Command="{Binding Path=DataContext.CancelProgramCommandAsync, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                    CommandParameter="{Binding}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <Path Fill="Red" Stretch="Uniform">
                                        <Path.Data>
                                            <GeometryGroup>
                                                <PathGeometry Figures="M36 32a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4h28a4 4 0 0 1 4 4v28z"/>
                                                <PathGeometry Figures="M 15 12 a 2 2 0 0 0-2 2 v 8 a 2 2 0 0 0 2 2 h 8 a2 2 0 0 0 2-2 V 14 a 2 2 0 0 0-2-2 H 13Z"/>
                                            </GeometryGroup>
                                        </Path.Data>
                                    </Path>

                                    <TextBlock Grid.Column="1" Text="Аннулировать"/>
                                </Grid>
                            </Button>
                        </WrapPanel>
                    </DataTemplate>
                </TabControl.Resources>

                <TabItem Header="Роботы">
                    <TabItem.Style>
                        <Style TargetType="{x:Type TabItem}" BasedOn="{StaticResource tabItemBase}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Роботы'}" Value="False">
                                    <Setter Property="Visibility" Value="Hidden"/>
                                    <Setter Property="Height" Value="0"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TabItem.Style>
                    <TabItem.Resources>
                        <Style TargetType="{x:Type Button}">
                            <Setter Property="Margin" Value="5"/>
                            <Setter Property="Height" Value="40"/>
                            <Setter Property="Width" Value="{Binding ActualHeight, RelativeSource={RelativeSource Self}}"/>
                        </Style>
                    </TabItem.Resources>

                    <Grid Margin="15">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="15"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <Button Grid.Row="0" Grid.Column="0" ToolTip="Удалить робота"
                                    Height="45" Width="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}"
                                    Template="{StaticResource buttonTemplate}"
                                    Command="{Binding Path=DeleteRobotCommand}">

                            <Path Stretch="Fill" Fill="Black"
                                      Data="M 10.6 34 c -0.7 0 -1.2 -0.2 -1.7 -0.7 -0.5 -0.5 -0.7 -1 -0.7 -1.7 V 8.5 H 7.7 c -0.3 0 -0.634700625 -0.11756875 -0.86815625 -0.352625C6.616861875 7.943812499999999 6.5 7.652669375 6.5 7.3051875c0 -0.34720562499999996 0.116861875 -0.635919375 0.35059375 -0.866125C7.084049375 6.208856875 7.3734375 6.09375 7.71875 6.09375h6.41875c0 -0.352080625 0.11683750000000001 -0.643231875 0.35059375 -0.8734375C14.721525 4.990106875 15.0109375 4.875 15.35625 4.875h8.2875c0.34531249999999997 0 0.63480625 0.116731875 0.8685624999999999 0.3501875 0.23343125 0.23373187499999998 0.3501875 0.52325 0.3501875 0.8685624999999999h6.41875c0.34531249999999997 0 0.63480625 0.11754437499999999 0.8685624999999999 0.352625 0.23343125 0.23481249999999998 0.3501875 0.5259556249999999 0.3501875 0.8734375 0 0.34720562499999996 -0.11675624999999999 0.635919375 -0.3501875 0.866125 -0.23375625 0.23018125 -0.52325 0.34531249999999997 -0.8685624999999999 0.34531249999999997h-0.446875V31.6875c0 0.6703125 -0.23863125000000002 1.2441 -0.7158125 1.72128125 -0.47750625 0.47750625 -1.051375 0.7162187499999999 -1.7216875000000003 0.7162187499999999h-17.79375Zm17.79375 -25.59375h-17.79375V31.6875h17.79375V8.53125ZM16.135437500000002 28.19375c0.34718125 0 0.6359437499999999 -0.11683750000000001 0.866125 -0.35059375 0.23018125 -0.23343125 0.34531249999999997 -0.5228437499999999 0.34531249999999997 -0.86815625V13.203125c0 -0.34531249999999997 -0.11756875 -0.63480625 -0.352625 -0.8685624999999999 -0.23481249999999998 -0.23343125 -0.52593125 -0.3501875 -0.8734375 -0.3501875 -0.34718125 0 -0.6359437499999999 0.11675624999999999 -0.866125 0.3501875 -0.23018125 0.23375625 -0.34531249999999997 0.52325 -0.34531249999999997 0.8685624999999999V26.975c0 0.34531249999999997 0.11756875 0.634725 0.352625 0.86815625 0.23481249999999998 0.23375625 0.52593125 0.35059375 0.8734375 0.35059375Zm6.74375 0c0.34718125 0 0.6359437499999999 -0.11683750000000001 0.866125 -0.35059375 0.23018125 -0.23343125 0.34531249999999997 -0.5228437499999999 0.34531249999999997 -0.86815625V13.203125c0 -0.34531249999999997 -0.11756875 -0.63480625 -0.352625 -0.8685624999999999 -0.23481249999999998 -0.23343125 -0.52593125 -0.3501875 -0.8734375 -0.3501875 -0.34718125 0 -0.6359437499999999 0.11675624999999999 -0.866125 0.3501875 -0.23018125 0.23375625 -0.34531249999999997 0.52325 -0.34531249999999997 0.8685624999999999V26.975c0 0.34531249999999997 0.11756875 0.634725 0.352625 0.86815625 0.23481249999999998 0.23375625 0.52593125 0.35059375 0.8734375 0.35059375Z"/>
                        </Button>

                        <ComboBox Grid.Row="0" Grid.Column="1" Margin="5" FontSize="18"
                                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                                      ItemsSource="{Binding Path=RobotsCollection, Mode=OneWay}"
                                      SelectedItem="{Binding Path=SelectedRobot, Mode=TwoWay}"                
                                      StaysOpenOnEdit="False" IsTextSearchCaseSensitive="False"  
                                      SelectedIndex="0">

                            <ComboBox.Style>
                                <Style TargetType="{x:Type ComboBox}">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=RobotsCollection.Count}" Value="0">
                                            <Setter Property="IsEnabled" Value="False"/>
                                            <Setter Property="IsEditable" Value="True"/>
                                            <Setter Property="Text" Value="Нет введёных роботов"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </ComboBox.Style>

                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="{x:Type ComboBoxItem}">
                                    <Setter Property="Height" Value="45"/>
                                    <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                                    <Setter Property="TextBlock.VerticalAlignment" Value="Center"/>
                                </Style>
                            </ComboBox.ItemContainerStyle>

                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name, Mode=OneWay}" Padding="0,5"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>

                        <Button Grid.Row="0" Grid.Column="2" ToolTip="Повторное соединение"
                                    Template="{StaticResource buttonTemplate}"
                                    Command="{Binding UpDateConnectionCommand}">
                            <Button.Style>
                                <Style TargetType="{x:Type Button}" BasedOn="{StaticResource buttonBaseStyle}">
                                    <Setter Property="Height" Value="0"/>
                                    <Setter Property="Width" Value="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}"/>

                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Path=SelectedRobot.IsConnection}" Value="False">
                                            <Setter Property="Height" Value="45"/>
                                        </DataTrigger>

                                        <DataTrigger Binding="{Binding Path=Visibility, RelativeSource={RelativeSource Self}}" Value="Visible">
                                            <DataTrigger.EnterActions>
                                                <BeginStoryboard Name="StartBlinking">
                                                    <Storyboard>
                                                        <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" RepeatBehavior="Forever" AutoReverse="True" Duration="0:0:1"/>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </DataTrigger.EnterActions>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>

                            <Image Stretch="Fill" Source="{StaticResource ImageUpdate}"/>
                        </Button>

                        <Button Grid.Row="0" Grid.Column="3" ToolTip="Добавить робота"
                                    Height="40" Width="{Binding Path=ActualHeight, RelativeSource={RelativeSource Self}}"
                                    Template="{StaticResource buttonTemplate}"
                                    Command="{Binding Path=AddRobotCommand}">

                            <Path Stroke="Black" StrokeThickness="2" Stretch="Fill">
                                <Path.Data>
                                    <GeometryGroup>
                                        <EllipseGeometry RadiusX="10" RadiusY="10" Center="12,12"/>
                                        <PathGeometry Figures="M 15 12 L12 12M12 12L9 12M12 12L12 9M12 12L12 15"/>
                                    </GeometryGroup>
                                </Path.Data>
                            </Path>
                        </Button>

                        <TabControl Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="4" TabStripPlacement="Bottom"
                                        Background="#a3a3a3" BorderBrush="#4a4a4a" BorderThickness="1.25">

                            <TabControl.Resources>
                                <Style TargetType="{x:Type TabItem}">
                                    <Setter Property="FontSize" Value="15"/>
                                    <Setter Property="Foreground" Value="Black"/>
                                    <Setter Property="MinWidth" Value="90"/>

                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type TabItem}">
                                                <Border Name="Panel">
                                                    <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                                          ContentSource="Header" Margin="15, 5"/>
                                                </Border>

                                                <ControlTemplate.Triggers>
                                                    <Trigger Property="IsSelected" Value="True">
                                                        <Setter TargetName="Panel" Property="Background" Value="#4a4a4a"/>
                                                        <Setter TargetName="Panel" Property="BorderBrush" Value="#3094ff"/>
                                                        <Setter TargetName="Panel" Property="BorderThickness"  Value="1.5"/>
                                                        <Setter TargetName="ContentSite" Property="TextElement.Foreground" Value="#3094ff"/>
                                                    </Trigger>

                                                    <Trigger Property="IsSelected" Value="False">
                                                        <Setter TargetName="Panel" Property="Background" Value="#b0b0b0"/>
                                                    </Trigger>
                                                </ControlTemplate.Triggers>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </TabControl.Resources>

                            <TabItem Header="Свойства">
                                <TabItem.Resources>
                                    <Style TargetType="{x:Type Label}">
                                        <Setter Property="FontSize" Value="14"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                    </Style>

                                    <Style TargetType="{x:Type TextBox}">
                                        <Setter Property="FontSize" Value="16"/>
                                        <Setter Property="Padding" Value="5"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                    </Style>
                                </TabItem.Resources>

                                <Grid Margin="15, 0, 15, 15">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="10"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="10"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="10"/>
                                        <RowDefinition Height="200*"/>
                                    </Grid.RowDefinitions>

                                    <Grid Grid.Row="0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="1.6*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <Label Grid.Row="0" Grid.Column="0" Content="Хост"/>
                                        <Label Grid.Row="0" Grid.Column="1" Content="Порт"/>

                                        <TextBox Grid.Row="1" Grid.Column="0" Text="{Binding Path=SelectedRobot.Host, Mode=TwoWay, FallbackValue='0.0.0.0', TargetNullValue='0.0.0.0', UpdateSourceTrigger=LostFocus}"/>
                                        <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding Path=SelectedRobot.Port, Mode=TwoWay, FallbackValue=0000, TargetNullValue=0000, UpdateSourceTrigger=LostFocus}"/>
                                    </Grid>

                                    <Grid Grid.Row="2">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="10"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <TextBox Grid.Column="0" Text="{Binding Path=SelectedRobot.PathProgramm, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>

                                        <Button Grid.Column="2" Height="40" Padding="5" Margin="0"
                                                    ToolTip="Изменить папку генерации"
                                                    Command="{Binding ChangePatnOnPCCommand}"
                                                    Template="{StaticResource buttonTemplate}">

                                            <Path Fill="Black" Stretch="Fill"
                                                      Data="M 277.974 49.076c65.267-65.379 171.733-65.49 237.448 0l232.186 232.187 1055.697 1055.809L1919.958 1920l-582.928-116.653-950.128-950.015 79.15-79.15 801.792 801.68 307.977-307.976-907.362-907.474L281.22 747.65 49.034 515.464c-65.379-65.603-65.379-172.069 0-237.448Zm1376.996 1297.96-307.977 307.976 45.117 45.116 384.999 77.023-77.023-385-45.116-45.116ZM675.355 596.258l692.304 692.304-79.149 79.15-692.304-692.305 79.149-79.15ZM396.642 111.88c-14.33 0-28.547 5.374-39.519 16.345l-228.94 228.94c-21.718 21.718-21.718 57.318 0 79.149l153.038 153.037 308.089-308.09-153.037-153.036c-10.972-10.971-25.301-16.345-39.63-16.345Z">
                                                <Path.LayoutTransform>
                                                    <RotateTransform Angle="90"/>
                                                </Path.LayoutTransform>
                                            </Path>
                                        </Button>
                                    </Grid>

                                    <control:Breadcrumb Grid.Row="4" Height="40" Padding="0"
                                                            Root="{Binding Path=DefaulRoot, Source={x:Type client:JsonRpcConnection}}"
                                                            Directory="{Binding Path=SelectedRobot.PathControllerFolder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                            ItemsSource="{Binding Path=SelectedRobot.Files, Mode=OneWay}"
                                                            UpDateCommand="{Binding Path=DataContext.UpDateFilesCommand, Mode=OneWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"
                                                            IsProgress="{Binding Path=SelectedRobot.IsLoadFiles, Mode=OneWay}"
                                                            SelectFilesCommand="{Binding Path=DataContext.DropFilesCommandAsync, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"
                                                            DeleteFilesCommand="{Binding Path=DataContext.DeleteFileCommandAsync, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"/>

                                    <control:NavigationTreeView Grid.Row="6" FontSize="18"
                                                                    DataFileIsHidden="{Binding Path=Settings.AccessDataFile, Source={x:Static Application.Current}, Mode=TwoWay}"
                                                                    SelectedFile="{Binding Path=DataContext.SelectedRobot.RobotProgramName, Mode=TwoWay, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"
                                                                    SelectItemCommand="{Binding Path=DataContext.SelectFileCommandAsync, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"
                                                                    SelectFolderCommand="{Binding Path=DataContext.SelectFolderCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"
                                                                    DeleteNodeCommand="{Binding Path=DataContext.DeleteFileCommandAsync, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Page}}}"
                                                                    ScrollViewer.CanContentScroll="False"
                                                                    ScrollViewer.VerticalScrollBarVisibility="Auto">

                                        <control:NavigationTreeView.FileCollection>
                                            <MultiBinding Converter="{StaticResource VisibilityFolderOnRobot}">
                                                <Binding Path="DataContext.SelectedRobot.Files" RelativeSource="{RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}"/>
                                                <Binding Path="Settings.AvailableFolders" Source="{x:Static Application.Current}"/>
                                            </MultiBinding>
                                        </control:NavigationTreeView.FileCollection>

                                        <control:NavigationTreeView.Style>
                                            <Style TargetType="{x:Type control:NavigationTreeView}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Path=SelectedRobot.IsLoadFiles, Mode=OneWay}" Value="True">
                                                        <Setter Property="IsEnabled" Value="False"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </control:NavigationTreeView.Style>
                                    </control:NavigationTreeView>
                                </Grid>
                            </TabItem>

                            <TabItem Header="Ток">
                                <TabItem.Resources>
                                    <Style TargetType="{x:Type Label}">
                                        <Setter Property="FontSize" Value="16"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                    </Style>

                                    <Style TargetType="{x:Type TextBox}">
                                        <Setter Property="FontSize" Value="14"/>
                                        <Setter Property="Padding" Value="5"/>
                                        <Setter Property="Margin" Value="5"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                    </Style>
                                </TabItem.Resources>

                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <Label Grid.Row="0">
                                        <Label.Content>
                                            <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Ток - {0}">
                                                <Binding Path="SelectedRobot.Current"  Mode="OneWay" TargetNullValue="0" FallbackValue="0" UpdateSourceTrigger="PropertyChanged"/>
                                            </MultiBinding>
                                        </Label.Content>
                                    </Label>

                                    <Label Grid.Row="1">
                                        <Label.Content>
                                            <MultiBinding Converter="{StaticResource StringFormatMultiConvert}" ConverterParameter="Усилие подачи - {0}">
                                                <Binding Path="SelectedRobot.WireFeed"  Mode="OneWay" TargetNullValue="0" FallbackValue="0" UpdateSourceTrigger="PropertyChanged"/>
                                            </MultiBinding>
                                        </Label.Content>
                                    </Label>

                                    <!--<lvc:CartesianChart Grid.Row="2" AnimationsSpeed="0:0:1.0" Hoverable="False" Zoom="X"
                                                             LegendLocation="Top" DataTooltip="{x:Null}"
                                                             Margin="0, 0, 10, 0">

                                                <lvc:CartesianChart.Series>
                                                    <lvc:LineSeries 
                                                        Values="{Binding Path=SelectedRobot.Item2.CurrentArray}" 
                                                                PointGeometry="{Binding Path=.}"
                                                                LineSmoothness="0.75"
                                                                StrokeThickness="5" 
                                                                Stroke="#ffe600"
                                                                Fill="Transparent"/>

                                                    <lvc:LineSeries Values="{Binding Path=SelectedRobot.Item2.WireFeedArray}" 
                                                                PointGeometry="{Binding Path=.}"
                                                                LineSmoothness="0.75"
                                                                StrokeThickness="5" 
                                                                Stroke="#F34336"
                                                                Fill="Transparent"/>
                                                </lvc:CartesianChart.Series>
                                                -->
                                    <!--<lvc:CartesianChart.AxisX>
                                            <lvc:Axis LabelFormatter="{Binding DateTimeFormatter}"
                                                      MaxValue="{Binding AxisMax}" 
                                                      MinValue="{Binding AxisMin}"
                                                      Unit="{Binding AxisUnit}">
                                                
                                                <lvc:Axis.Separator>
                                                    <lvc:Separator Step="{Binding AxisStep}" />
                                                </lvc:Axis.Separator>
                                            </lvc:Axis>
                                        </lvc:CartesianChart.AxisX>-->
                                    <!--
                                            </lvc:CartesianChart>-->
                                </Grid>
                            </TabItem>
                        </TabControl>
                    </Grid>
                </TabItem>

                <TabItem Header="Управление">
                    <TabItem.Style>
                        <Style TargetType="{x:Type TabItem}" BasedOn="{StaticResource tabItemBase}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Управление'}" Value="False">
                                    <Setter Property="Visibility" Value="Hidden"/>
                                    <Setter Property="Height" Value="0"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TabItem.Style>
                    
                    <ListView SelectionMode="Single" FontSize="18" Margin="15"
                              ScrollViewer.CanContentScroll="True"
                              ScrollViewer.VerticalScrollBarVisibility="Auto"
                              ScrollViewer.HorizontalScrollBarVisibility="Auto"
                              ItemsSource="{Binding Path=RobotsCollection, Mode=OneWay}">
                        
                        <ListView.Resources>
                            <Style TargetType="{x:Type Button}">
                                <Setter Property="Height" Value="45"/>
                                <Setter Property="Background" Value="White"/>
                                <Setter Property="Padding" Value="5"/>
                                <Setter Property="Margin" Value="5"/>
                            </Style>

                            <Style TargetType="{x:Type TextBlock}" BasedOn="{StaticResource textBlockBase}">
                                <Setter Property="TextWrapping" Value="Wrap"/>
                            </Style>
                        </ListView.Resources>

                        <ListView.ItemContainerStyle>
                            <Style TargetType="{x:Type ListViewItem}">
                                <Setter Property="Padding" Value="0,20"/>
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                            </Style>
                        </ListView.ItemContainerStyle>

                        <ListView.View>
                            <GridView>
                                <GridViewColumn CellTemplate="{StaticResource buttonDelete}"></GridViewColumn>
                                <GridViewColumn DisplayMemberBinding="{Binding Path=Name}">Название</GridViewColumn>
                                <GridViewColumn CellTemplate="{StaticResource buttonRename}"></GridViewColumn>
                                <GridViewColumn CellTemplate="{StaticResource robotControl}" Width="Auto"></GridViewColumn>
                                <GridViewColumn x:Name="StatusColumn" 
                                                CellTemplate="{StaticResource textBlockStatus}" 
                                                Width="{Binding Path=DataContext.StatusColumnWidth, Mode=TwoWay,
                                                        RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}">
                                    Статус
                                </GridViewColumn>
                            </GridView>
                        </ListView.View>

                        <!--<i:Interaction.Triggers>
                            <i:EventTrigger EventName="MouseDoubleClick">
                                <i:InvokeCommandAction Command="{Binding Path=SelectRobotCommand}"
                                                       CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type ListView}, Mode=FindAncestor}}"/>
                            </i:EventTrigger>
                        </i:Interaction.Triggers>-->
                    </ListView>
                </TabItem>

                <TabItem Header="Программа">
                    <TabItem.Style>
                        <Style TargetType="{x:Type TabItem}" BasedOn="{StaticResource tabItemBase}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=Settings.AvailableTab, Source={x:Static Application.Current}, 
                                             Converter={StaticResource CollectionsStringToBoolConvert}, ConverterParameter='Программа'}" Value="False">
                                    <Setter Property="Visibility" Value="Hidden"/>
                                    <Setter Property="Height" Value="0"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TabItem.Style>
                    
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <Grid Margin="15">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="25"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <Grid.Resources>
                                    <Style TargetType="{x:Type TextBox}">
                                        <Setter Property="FontSize" Value="16"/>
                                        <Setter Property="Padding" Value="0, 5"/>
                                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    </Style>
                                </Grid.Resources>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Label Grid.Column="0" Content="Имя программы" FontSize="16"/>
                                <TextBox Grid.Column="1" Text="{Binding Path=ProgrammName, Mode=TwoWay}" MinWidth="200"/>
                            </Grid>

                            <ComboBox Grid.Row="2" Margin="0" Padding="0, 10" FontSize="18" FontWeight="DemiBold"
                                      VerticalContentAlignment="Center" HorizontalContentAlignment="Center"
                                      ItemsSource="{Binding Path=DetalTypeCollection, Mode=OneWay}"
                                      SelectedItem="{Binding Path=SelectedDetalType, Mode=OneWayToSource}"
                                      SelectedIndex="0">

                                <ComboBox.ItemContainerStyle>
                                    <Style TargetType="{x:Type ComboBoxItem}">
                                        <Setter Property="Height" Value="45"/>
                                        <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                                        <Setter Property="TextBlock.VerticalAlignment" Value="Center"/>
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                            </ComboBox>

                            <TabControl Name="tabControlParam" Grid.Row="4" TabStripPlacement="Right" 
                                        Margin="0" MaxHeight="600"
                                        SelectedItem="{Binding Path=SelectedItem, UpdateSourceTrigger=PropertyChanged, Mode=OneWayToSource}">

                                <TabControl.Resources>
                                    <Style TargetType="{x:Type TabItem}">
                                        <Setter Property="FontSize" Value="15"/>
                                        <Setter Property="Padding" Value="5"/>
                                        <Setter Property="Height" Value="90"/>

                                        <Setter Property="HeaderTemplate">
                                            <Setter.Value>
                                                <DataTemplate>
                                                    <ContentPresenter Content="{TemplateBinding Content}">
                                                        <ContentPresenter.LayoutTransform>
                                                            <RotateTransform Angle="90" />
                                                        </ContentPresenter.LayoutTransform>
                                                    </ContentPresenter>
                                                </DataTemplate>
                                            </Setter.Value>
                                        </Setter>

                                        <!--<Style.Triggers>
                                            <DataTrigger Binding="{Binding Path=Header, RelativeSource={RelativeSource Self}}" Value="Скосы">
                                                <Setter Property="Visibility" Value="Hidden"/>
                                            </DataTrigger>

                                            <MultiDataTrigger>
                                                <MultiDataTrigger.Conditions>
                                                    <Condition Binding="{Binding Path=Header, RelativeSource={RelativeSource Self}}" Value="Скосы"/>
                                                    <Condition Binding="{Binding Path=SelectedType}" Value="Настил со скосами"/>
                                                </MultiDataTrigger.Conditions>

                                                <Setter Property="Visibility" Value="Visible" />
                                            </MultiDataTrigger>
                                        </Style.Triggers>-->
                                    </Style>
                                </TabControl.Resources>

                                <TabItem Header="Общие">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                        <ContentControl>
                                            <ContentControl.Style>
                                                <Style TargetType="ContentControl">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ContentControl">
                                                                <ContentControl ContentTemplate="{StaticResource OtherTemplateStyle}"/>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>

                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=SelectedDetalType}" Value="Настил с ребром">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="ContentControl">
                                                                        <ContentControl ContentTemplate="{StaticResource PlitaTemplateStyle}"/>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ContentControl.Style>
                                        </ContentControl>
                                    </ScrollViewer>
                                </TabItem>

                                <TabItem Header="Доп.">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                        <ContentControl>
                                            <ContentControl.Style>
                                                <Style TargetType="ContentControl">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ContentControl">
                                                                <ContentControl ContentTemplate="{StaticResource OtherTemplateStyle}"/>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>

                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=SelectedDetalType}" Value="Настил с ребром">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="ContentControl">
                                                                        <ContentControl ContentTemplate="{StaticResource PlitaDopTemplateStyle}"/>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ContentControl.Style>
                                        </ContentControl>
                                    </ScrollViewer>
                                </TabItem>

                                <TabItem Header="Сварка">
                                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                                        <ContentControl>
                                            <ContentControl.Style>
                                                <Style TargetType="ContentControl">
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ContentControl">
                                                                <ContentControl ContentTemplate="{StaticResource OtherTemplateStyle}"/>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>

                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Path=SelectedDetalType}" Value="Настил с ребром">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="ContentControl">
                                                                        <ContentControl ContentTemplate="{StaticResource PlitaSvarkaTemplateStyle}"/>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ContentControl.Style>
                                        </ContentControl>
                                    </ScrollViewer>
                                </TabItem>
                            </TabControl>

                            <StackPanel Grid.Row="6" Orientation="Vertical">
                                <ToggleButton Name="toggleButtonInfo" Width="45" Height="45" HorizontalAlignment="Left" Style="{StaticResource toggleButtonInfoStyle}"/>

                                <Border Padding="7" Width="600" Margin="5" BorderThickness="5"
                                        BorderBrush="#FF1680C9" Background="#FFD5EBFD"
                                        HorizontalAlignment="Left">

                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path=IsChecked, ElementName=toggleButtonInfo}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                            <Setter Property="Visibility" Value="Hidden"/>
                                        </Style>
                                    </Border.Style>

                                    <TextBlock TextWrapping="Wrap" FontSize="16.5" FontWeight="Bold">
                                        <TextBlock.Style>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="Text" Value="# Крайняя левая (как на чертеже) точка детали устанавливается по краю первого козелка. &#x0a;&#x0a;# Верхний торец - по продольным упорам на козелках.&#x0a;&#x0a;# Все отсчёты ведутся от 0, образованного продольным и поперечным упорами на первом козелке."/>

                                                <Style.Triggers>
                                                    <MultiDataTrigger>
                                                        <MultiDataTrigger.Conditions>
                                                            <Condition Binding="{Binding Path=SelectedItem.Header, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}" Value="Общие"/>
                                                            <Condition Binding="{Binding Path=DetalObject.ScoseType, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}" Value="d_rect"/>
                                                        </MultiDataTrigger.Conditions>

                                                        <Setter Property="Text" Value="# Верхний левый угол детали (как на чертеже) устанавливается в 0 точку сварочного комплекса, образованную торцевыми упорами на козелках."/>
                                                    </MultiDataTrigger>


                                                    <DataTrigger Binding="{Binding Path=SelectedItem.Header, UpdateSourceTrigger=PropertyChanged, Mode=OneWay}" Value="Сварка">
                                                        <Setter Property="Text" Value="Т3-ИП6  == 37 см/м&#x0a;Т3-ИП8  == 31 см/м&#x0a;Т3-ИП10 == 24 см/м"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </TextBlock.Style>
                                    </TextBlock>
                                </Border>
                            </StackPanel>
                        </Grid>
                    </ScrollViewer>
                </TabItem>

                <!--<i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectionChanged">
                        <i:InvokeCommandAction Command="{Binding Path=OpenCodingCommand}" CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type TabControl}, Mode=FindAncestor}}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>-->
            </TabControl>

            <GridSplitter Grid.Column="1" ShowsPreview="False" Width="2" Margin="0"
                          HorizontalAlignment="Center" VerticalAlignment="Stretch"
                          ResizeDirection="Columns"  ResizeBehavior="BasedOnAlignment"
                          DragDelta="ColumnSplitterDragDelta"/>

            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition x:Name="topRow" Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition x:Name="bottomRow" Height="Auto"/>
                </Grid.RowDefinitions>

                <Grid Grid.Row="0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <Grid.Style>
                        <Style TargetType="{x:Type Grid}">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=Settings.VisibilityPictures, Source={x:Static Application.Current}}" Value="False">
                                    <Setter Property="Visibility" Value="Hidden"/>
                                    <Setter Property="Height" Value="0"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>

                    <ScrollViewer Grid.Row="0" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Margin="15"
                                      HorizontalAlignment="Center" VerticalAlignment="Center"
                                      Height="{Binding RelativeSource={RelativeSource Self}, Path=Child.ActualHeight}"
                                      Width="{Binding RelativeSource={RelativeSource Self}, Path=Child.ActualWidth}">

                        <control:Image2D Grid.Row="0"
                                     Width="Auto" Height="Auto" Stretch="Fill"
                                     Source="{Binding Path=DataContext.DetalObject.GenericImage, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}">

                            <control:Image2D.Style>
                                <Style TargetType="{x:Type control:Image2D}">
                                    <Setter Property="MaxHeight" Value="600"/>

                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding Path=DataContext.DetalObject.DetalType, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}" Value="Настил с ребром"/>
                                                <Condition Binding="{Binding Path=DataContext.DetalObject.ScoseType, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}" Value="d_rect"/>
                                            </MultiDataTrigger.Conditions>

                                            <Setter Property="MaxHeight" Value="400"/>
                                        </MultiDataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </control:Image2D.Style>

                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDoubleClickEvent">
                                    <i:InvokeCommandAction Command="{Binding Path=DataContext.OpenImageCommand, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                                       CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type Image}, Mode=FindAncestor}}"/>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </control:Image2D>
                    </ScrollViewer>

                    <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto" Margin="15"
                                      HorizontalAlignment="Center" VerticalAlignment="Center"
                                      Height="{Binding RelativeSource={RelativeSource Self}, Path=Child.ActualHeight}"
                                      Width="{Binding RelativeSource={RelativeSource Self}, Path=Child.ActualWidth}">

                        <control:Image2D Grid.Row="1"
                                     Width="Auto" Height="Auto" Stretch="Fill"
                                     Source="{Binding Path=DataContext.DetalObject.RebraImage, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}">

                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="MouseDoubleClickEvent">
                                    <i:InvokeCommandAction Command="{Binding Path=DataContext.OpenImageCommand, RelativeSource={RelativeSource AncestorType={x:Type Page}, Mode=FindAncestor}}"
                                                       CommandParameter="{Binding Path=., RelativeSource={RelativeSource AncestorType={x:Type Image}, Mode=FindAncestor}}"/>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </control:Image2D>
                    </ScrollViewer>
                </Grid>

                <GridSplitter Grid.Row="1" ShowsPreview="False" Height="2" Margin="0"
                              HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                              ResizeDirection="Rows" ResizeBehavior="PreviousAndNext"
                              DragDelta="RowSplitterDragDelta"/>

                <Grid Grid.Row="2">
                    <TabControl TabStripPlacement="Bottom" Margin="15"
                                Background="#a3a3a3" BorderBrush="#4a4a4a" BorderThickness="1.25">

                        <TabControl.Resources>
                            <Style TargetType="{x:Type TabItem}">
                                <Setter Property="FontSize" Value="15"/>
                                <Setter Property="Foreground" Value="Black"/>
                                <Setter Property="MinWidth" Value="90"/>

                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="TabItem">
                                            <Grid Name="Panel">
                                                <ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center"
                                                                          ContentSource="Header" Margin="15, 5"/>
                                            </Grid>

                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsSelected" Value="True">
                                                    <Setter TargetName="Panel" Property="Background" Value="#4a4a4a"/>
                                                    <Setter TargetName="ContentSite" Property="TextElement.Foreground" Value="#3094ff"/>
                                                </Trigger>

                                                <Trigger Property="IsSelected" Value="False">
                                                    <Setter TargetName="Panel" Property="Background" Value="#a3a3a3"/>
                                                </Trigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </TabControl.Resources>

                        <TabItem Header="Сообщения">
                            <Grid>
                                <DataGrid FontSize="15" Margin="3"
                                          ItemsSource="{Binding Path=MessagesCollection, Mode=OneWay}"
                                          SelectionMode="Single"
                                          AutoGenerateColumns="False"
                                          EnableRowVirtualization="False"
                                          ScrollViewer.CanContentScroll="True"
                                          ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                          ScrollViewer.VerticalScrollBarVisibility="Auto"
                                          lib:ScrollViewerAttachedPropertiesDataGrid.ScrollOnLoadingRow="True">

                                    <DataGrid.Resources>
                                        <Style x:Key="dgCellBase" TargetType="{x:Type DataGridCell}">
                                            <Setter Property="IsEnabled" Value="False"/>
                                            <Setter Property="Focusable" Value="False"/>
                                            <Setter Property="Foreground" Value="Black"/>
                                            <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate TargetType="{x:Type DataGridCell}">
                                                        <Grid Background="{TemplateBinding Background}">
                                                            <ContentPresenter VerticalAlignment="Center" Margin="15,0"/>
                                                        </Grid>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>

                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding LogLevel}" Value="Error">
                                                    <Setter Property="Foreground" Value="Red"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>

                                        <Style TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource dgCellBase}"></Style>

                                        <Style x:Key="dgCellLeft" TargetType="{x:Type DataGridCell}" BasedOn="{StaticResource dgCellBase}">
                                            <Setter Property="TextBlock.TextAlignment" Value="Left"/>
                                        </Style>

                                        <Style TargetType="{x:Type DataGridColumnHeader}">
                                            <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                        </Style>

                                        <Style TargetType="{x:Type DataGridRowHeader}">
                                            <!--<EventSetter Event="Click" Handler="DataGridRowHeader_Click"/>-->

                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Path=Item.Ditails, RelativeSource={RelativeSource AncestorType={x:Type DataGridRow}}}" Value="">
                                                    <Setter Property="IsEnabled" Value="False"/>
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </DataGrid.Resources>
                                    
                                    <DataGrid.RowHeaderTemplate>
                                        <DataTemplate>
                                            <Expander Expanded="Expander_Expanded"  Collapsed="Expander_Collapsed">
                                                <Expander.Style>
                                                    <Style TargetType="{x:Type Expander}">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding Path=Item.Ditails, RelativeSource={RelativeSource AncestorType={x:Type DataGridRow}}}" Value="">
                                                                <Setter Property="Visibility" Value="Hidden"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Expander.Style>
                                            </Expander>
                                        </DataTemplate>
                                    </DataGrid.RowHeaderTemplate>

                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="Время" Binding="{Binding Time, StringFormat=\{0:HH:mm:ss\}}" Width="Auto"/>
                                        <DataGridTextColumn Header="Сообщение" Binding="{Binding Message}" Width="*" CellStyle="{StaticResource dgCellLeft}"/>
                                    </DataGrid.Columns>

                                    <DataGrid.RowDetailsTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Ditails}" Focusable="False" IsEnabled="False" Padding="5,10"/>
                                        </DataTemplate>
                                    </DataGrid.RowDetailsTemplate>
                                </DataGrid>
                            </Grid>
                        </TabItem>
                    </TabControl>
                </Grid>
            </Grid>
        </Grid>

        <DockPanel Grid.Row="2" Background="#FF1680C9">
            <Menu Background="Transparent">
                <Menu.ItemsPanel>
                    <ItemsPanelTemplate>
                        <DockPanel HorizontalAlignment="Stretch"/>
                    </ItemsPanelTemplate>
                </Menu.ItemsPanel>

                <Menu.Resources>
                    <Style TargetType="{x:Type TextBlock}">
                        <Setter Property="FontSize" Value="14"/>
                        <Setter Property="Foreground" Value="White"/>
                        <Setter Property="TextAlignment" Value="Center"/>
                        <Setter Property="VerticalAlignment" Value="Center"/>
                    </Style>
                </Menu.Resources>

                <MenuItem Background="Transparent" Width="Auto" Command="{Binding HelpCommand}" CommandParameter="{Binding Path=.}">
                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Path Grid.Column="0" Fill="White" RenderTransformOrigin="0.5, 0.5" Margin="-2, -1.5, 0, 0"
                                      Data="M11,18H13V16H11V18M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6A4,4 0 0,0 8,10H10A2,2 0 0,1 12,8A2,2 0 0,1 14,10C14,12 11,11.75 11,15H13C13,12.75 16,12.5 16,10A4,4 0 0,0 12,6Z">
                                    <Path.RenderTransform>
                                        <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    </Path.RenderTransform>
                                </Path>
                                <TextBlock Grid.Column="2" Text="Help"/>
                            </Grid>
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>

                <MenuItem Background="Transparent" Width="Auto" HorizontalAlignment="Right" 
                          Command="{Binding Path=PropertiesCommand}">

                    <MenuItem.Header>
                        <StackPanel Orientation="Horizontal">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="5"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <Path Grid.Column="0" Fill="White" Margin="0,-1.5,0,0"
                                      Data="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.21,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                                <TextBlock Grid.Column="2" Text="Настройки"/>
                            </Grid>
                        </StackPanel>
                    </MenuItem.Header>
                </MenuItem>
            </Menu>
        </DockPanel>
    </Grid>
</Page>
